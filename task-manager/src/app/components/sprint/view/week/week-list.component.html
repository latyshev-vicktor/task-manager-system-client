<div class="weeks-grid">
  @for (w of weeks; track w.id) {
    <div 
      tuiCardLarge 
      tuiAppearance="positive" 
      class="week-card"
      cdkDropList
      [cdkDropListData]="w.tasks"
      (cdkDropListDropped)="onTaskDropped($event, w)"
      (cdkDropListEntered)="onDragEntered($event, w)"
      (cdkDropListExited)="onDragExited($event, w)"
      [class.cdk-drop-list-receiving]="isReceiving(w.id)">
      
      <header tuiHeader class="week-header">
        <h3 tuiTitle>
          –ù–µ–¥–µ–ª—è {{w.weekNumber}}
          <span tuiSubtitle>–°—Ä–æ–∫: {{ w.startDate | date : 'dd.MM.yyyy' }} ‚Äî {{ w.endDate | date : 'dd.MM.yyyy' }}</span>
        </h3>
        <div class="week-badge">
          <span class="task-count">{{ w.tasks?.length || 0 }} –∑–∞–¥–∞—á</span>
        </div>
      </header>

      <div class="tasks-container">
        @if (w.tasks && w.tasks.length > 0) {
          <div class="tasks">
            @for (task of w.tasks; track task.id) {
              <div class="task-item">
                <div class="task-checkbox-wrapper">
                  <input 
                    type="checkbox" 
                    [checked]="task.status?.name === 'Completed'"
                    [id]="'week-task-' + task.id"
                    class="task-checkbox" />
                </div>
                <label 
                  [for]="'week-task-' + task.id" 
                  class="task-label"
                  [class.completed]="task.status?.name === 'Completed'">
                  <span class="task-name">{{ task.name }}</span>
                  @if (task.description) {
                    <span class="task-description">{{ task.description }}</span>
                  }
                </label>
              </div>
            }
          </div>
        } @else {
          <div class="empty-week">
            <div class="empty-icon">üìã</div>
            <p class="empty-text">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∑–∞–¥–∞—á–∏ —Å—é–¥–∞</p>
            <p class="empty-hint">–ó–∞–¥–∞—á–∏ –∏–∑ —Ü–µ–ª–µ–π –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞—Ç—å –≤ –Ω–µ–¥–µ–ª–∏</p>
          </div>
        }
      </div>
    </div>
  }
</div>
