<header class="navbar">
  <div class="navbar-left">
    <button 
      tuiButton 
      type="button" 
      appearance="flat" 
      size="s"
      (click)="onMenuToggle()"
      class="menu-toggle"
      title="Переключить меню">
      <lucide-icon [img]="Menu" size="20"></lucide-icon>
    </button>
    
    <h1 class="page-title">{{ pageTitle }}</h1>
    
    @if(breadcrumbs.length > 0) {
      <nav class="breadcrumb">
        <span 
          *ngFor="let crumb of breadcrumbs; let last = last" 
          class="breadcrumb-item"
          [class.active]="last">
          {{ crumb }}
          @if(!last) {
            <lucide-icon
              [img]="ChevronRight" 
              size="16"
              class="breadcrumb-separator">
            </lucide-icon>
          }
        </span>
      </nav>
    }
  </div>
  
  <div class="navbar-right">
    <button 
      tuiButton 
      type="button" 
      appearance="flat" 
      size="s" 
      class="nav-action"
      title="Поиск">
      <lucide-icon [img]="Search" size="18"></lucide-icon>
    </button>
    
    <div class="notification-wrapper" #notificationWrapper>
      <button 
        tuiButton 
        type="button" 
        appearance="flat" 
        size="s" 
        class="nav-action notification-btn"
        [class.active]="isNotificationDropdownOpen"
        (click)="toggleNotificationDropdown()"
        title="Уведомления">
        <lucide-icon [img]="Bell" size="18"></lucide-icon>
        @if(unreadCount > 0) {
          <span class="notification-badge">
            {{ unreadCount > 99 ? '99+' : unreadCount }}
          </span>
        }
      </button>
      
      @if(isNotificationDropdownOpen) {
        <div class="notification-dropdown">
          <div class="notification-header">
            <h3 class="notification-title">Уведомления</h3>
            @if(unreadCount > 0) {
              <button 
                tuiButton 
                type="button" 
                appearance="flat" 
                size="xs"
                class="mark-all-read-btn"
                (click)="markAllAsRead()">
                Прочитать все
              </button>
            }
          </div>
          
          <div class="notification-list" tuiScrollbar>
            @if(notifications.length === 0) {
              <div class="notification-empty">
                <p>Нет уведомлений</p>
              </div>
            } @else {
              @for(notification of notifications; track notification.id) {
                <div 
                  class="notification-item"
                  [class.unread]="!notification.isRead"
                  (click)="onNotificationClick(notification)">
                  <div class="notification-content">
                    <h4 class="notification-item-title">{{ notification.title }}</h4>
                    <p class="notification-item-message">{{ notification.message }}</p>
                    <span class="notification-item-time">{{ formatDate(notification.createdDate) }}</span>
                  </div>
                  @if(!notification.isRead) {
                    <div class="notification-dot"></div>
                  }
                </div>
              }
            }
          </div>
        </div>
      }
    </div>
    
    <!-- User Menu -->
    <div class="user-menu">
      <button 
        tuiButton
        type="button" 
        appearance="primary" 
        size="l" 
        class="user-button">
        <div class="user-avatar">
          <lucide-icon [img]="User" size="20"></lucide-icon>
        </div>
        <div class="user-info" *ngIf="user$ | async as user">
          <span class="user-name">{{ user.firstName }} {{ user.lastName }}</span>
          <span class="user-email">{{ user.email }}</span>
        </div>
        <lucide-icon [img]="ChevronDown" size="16" class="user-dropdown-icon"></lucide-icon>
      </button>
    </div>
  </div>
</header>